# 宿舍管理系统（arrebol）交付文档

> 适用对象：甲方业务人员（无技术基础） + 甲方运维/技术对接人员


## 目录（TOC）

- [1. 第一部分：项目特点与功能开发情况（面向非技术）](#1-第一部分项目特点与功能开发情况面向非技术)
  - [1.1 项目简介](#11-项目简介)
  - [1.2 角色与使用场景](#12-角色与使用场景)
  - [1.3 技术特点（你需要知道的“系统能力”）](#13-技术特点你需要知道的系统能力)
  - [1.4 功能模块清单与完成度](#14-功能模块清单与完成度)
  - [1.5 常见使用流程（点击路径 + 截图占位符）](#15-常见使用流程点击路径--截图占位符)
  - [1.6 关键业务规则（重要）](#16-关键业务规则重要)
- [2. 第二部分：接口与运维文档（面向运维/技术对接）](#2-第二部分接口与运维文档面向运维技术对接)
  - [2.1 部署架构建议](#21-部署架构建议)
  - [2.2 环境要求](#22-环境要求)
  - [2.3 配置说明（后端 application.yml）](#23-配置说明后端-applicationyml)
  - [2.4 数据库说明](#24-数据库说明)
  - [2.5 启动/停止/日志/健康检查](#25-启动停止日志健康检查)
  - [2.6 前端构建与部署（Nginx 示例）](#26-前端构建与部署nginx-示例)
  - [2.7 API 统一约定（返回结构/认证/错误码）](#27-api-统一约定返回结构认证错误码)
  - [2.8 接口文档（按模块）](#28-接口文档按模块)
  - [2.9 权限点（Permission Codes）清单](#29-权限点permission-codes清单)
  - [2.10 故障排查（FAQ）](#210-故障排查faq)
  - [2.11 安全建议（强烈建议上线前完成）](#211-安全建议强烈建议上线前完成)


---

# 1. 第一部分：项目特点与功能开发情况（面向非技术）

## 1.1 项目简介

本项目为“宿舍管理系统”，用于对宿舍相关业务进行统一管理，主要覆盖：

- 宿舍资源：楼栋/房间/床位
- 学生信息
- 入住与退宿（入住记录）
- 报修工单
- 访客登记

项目采用“前后端分离”的管理后台形式：

- 管理端（网页）用于日常使用
- 后端服务提供数据接口与权限控制
- 数据存储在 MySQL 数据库


## 1.2 角色与使用场景

本系统从业务角度可对应以下角色（可按权限控制做“能看什么、能操作什么”）：

- 管理员（超级管理员）
  - 负责基础数据维护（楼栋/房间/床位/学生）
  - 办理入住/退宿
  - 处理报修、访客登记
- 宿管/宿舍管理员
  - 主要使用宿舍资源与入住管理
- 维修人员/后勤
  - 主要使用报修工单（查看、接单、处理、完结）
- 门卫/前台
  - 主要使用访客登记

> 说明：当前系统的“角色/权限管理界面”未完整实现（见后文完成度），但数据库层面已具备 RBAC 表结构与权限点。


## 1.3 技术特点（你需要知道的“系统能力”）

- 前后端分离
  - 前端项目：`dormitory-admin-web`（Vue3 + ElementPlus）
  - 后端项目：`dormitory-server`（Spring Boot）

- 统一 API 前缀
  - 后端 API 统一以 `/api/v1` 开头

- 认证方式：JWT
  - 登录成功后，前端保存 Token
  - 后续请求在请求头携带：`Authorization: Bearer <token>`

- 权限控制：RBAC（角色-权限）
  - 后端通过权限点（例如 `dorm:building:read`）控制接口访问
  - 前端也会基于 `/api/v1/auth/me` 返回的权限点做页面访问拦截

- 数据库迁移：Flyway
  - 所有表结构与种子数据通过 Flyway 版本脚本管理
  - 迁移目录：`dormitory-server/src/main/resources/db/migration`

- 软删除
  - 多数业务表含 `deleted` 字段，删除通常为“软删除”（不会物理删除）


## 1.4 功能模块清单与完成度

> 完成度说明：
> - **已完成**：可用、前后端打通
> - **部分完成**：后端有能力但缺少管理界面/缺少部分操作
> - **未完成**：仅建表或规划，未提供接口/界面

| 模块 | 功能点 | 完成度 | 备注 |
| --- | --- | --- | --- |
| 登录/认证 | 登录、获取当前用户信息（me） | 已完成 | `/api/v1/auth/login`、`/api/v1/auth/me` |
| 用户体系 | 用户列表 | 已完成 | `/api/v1/sys/users` 仅列表 |
| 角色/权限管理 | 角色/权限增删改查、用户分配角色 | 未完成 | DB 表已存在，但缺少管理接口/页面 |
| 宿舍楼栋 | 楼栋 CRUD、分页查询 | 已完成 | 权限：`dorm:building:read/write` |
| 宿舍房间 | 房间 CRUD、分页查询 | 已完成 | 权限：`dorm:room:read/write` |
| 宿舍床位 | 床位 CRUD、分页查询 | 已完成 | 权限：`dorm:bed:read/write` |
| 学生管理 | 学生 CRUD、分页查询 | 已完成 | 权限：`student:read/write` |
| 入住管理 | 入住记录查询、办理入住、退宿/结束入住 | 已完成 | 入住冲突校验已实现（见业务规则） |
| 报修工单 | 列表/详情/创建/指派/状态流转/日志 | 已完成 | 权限：`repair:*` |
| 访客登记 | 列表/详情/登记/离开登记 | 已完成 | 权限：`visitor:*` |
| 公告 notice | 公告发布/草稿/置顶 | 未完成 | DB 表已存在 `notice`，缺少接口/页面 |
| 审计 audit_log | 操作审计日志落库与查询 | 未完成 | DB 表已存在 `audit_log`，缺少接口/页面 |


## 1.4.1 默认账号（演示/交付初始账号）

数据库中默认写入了两个账号（Flyway 种子数据）：

- `admin` / `123456`（建议上线后立即修改）
- `user` / `123456`

其中 `admin` 被授予 `SUPER_ADMIN` 角色，并拥有系统已定义的全部权限点。

> 账号与密码的初始化数据来自迁移脚本：
> - `V2__rbac_seed.sql`（创建账号）
> - `V3__rbac_password_fix.sql`（修正密码哈希）


## 1.5 常见使用流程（点击路径 + 截图占位符）

> 说明：以下流程以“管理端”为主；不同用户因权限不同，页面入口可能不同。

### 1.5.1 登录

- 打开管理端网址
- 输入账号密码
- 点击“登录”

截图占位符：

- `![登录页](./images/01-login.png)`


### 1.5.2 维护宿舍资源（楼栋/房间/床位）

建议顺序：**先楼栋 -> 再房间 -> 再床位**

- 楼栋管理：进入“楼栋管理”
  - 新增楼栋（示例：B1 一号楼）
- 房间管理：进入“房间管理”
  - 选择楼栋、楼层、房间号
- 床位管理：进入“床位管理”
  - 为某房间添加床位（A/B/C/D...）

截图占位符：

- `![楼栋管理](./images/02-buildings.png)`
- `![房间管理](./images/03-rooms.png)`
- `![床位管理](./images/04-beds.png)`


### 1.5.3 维护学生信息

- 进入“学生管理”
- 新增学生（学号、姓名、性别等）

截图占位符：

- `![学生管理](./images/05-students.png)`


### 1.5.4 办理入住/退宿

- 进入“入住管理”
- 办理入住
  - 选择学生
  - 选择床位
  - 填写原因（可选）
- 办理退宿
  - 对“ACTIVE”的入住记录，点击结束入住

截图占位符：

- `![入住管理](./images/06-assignments.png)`


### 1.5.5 报修工单流转

- 进入“报修工单”
- 新建报修（标题必填）
- 指派维修人员
- 状态流转（允许：SUBMITTED -> IN_PROGRESS -> DONE / REJECTED）
- 查看日志

截图占位符：

- `![报修工单](./images/07-repairs.png)`


### 1.5.6 访客登记

- 进入“访客登记”
- 新增登记（访客姓名必填）
- 离开登记（从 IN 变为 OUT）

截图占位符：

- `![访客登记](./images/08-visitors.png)`


## 1.6 关键业务规则（重要）

### 1.6.1 入住记录（Dorm Assignment）

- 每个学生同一时间只能有 1 条有效入住记录
  - 若学生已存在 ACTIVE 入住记录，则新建入住会失败
  - 错误码：`40901`（`student already has active assignment`）

- 每个床位同一时间只能被 1 位学生占用
  - 若床位已有 ACTIVE 入住记录，则新建入住会失败
  - 错误码：`40902`（`bed already occupied`）

- 入住成功后，床位状态从 `AVAILABLE` 变为 `OCCUPIED`
- 退宿（结束入住）成功后，床位状态恢复为 `AVAILABLE`

- 入住状态：
  - `ACTIVE`：在住
  - 结束入住后不再为 `ACTIVE`（当前实现使用 `endAssignment` 将记录置为结束状态，并填写 `end_at`）

### 1.6.2 报修工单（Repair）

- 优先级 `priority` 允许值：`LOW` / `MEDIUM` / `HIGH`
- 状态 `status` 允许值：
  - `SUBMITTED`（已提交）
  - `IN_PROGRESS`（处理中）
  - `DONE`（已完成）
  - `REJECTED`（已拒绝）
- 状态流转约束：
  - `SUBMITTED` -> `IN_PROGRESS` 或 `REJECTED`
  - `IN_PROGRESS` -> `DONE` 或 `REJECTED`
  - `DONE/REJECTED` 为终态，不允许再改

### 1.6.3 访客登记（Visitor）

- 访客状态 `status`：
  - `IN`：在访（`leave_at` 必须为 NULL）
  - `OUT`：已离开（`leave_at` 必须不为 NULL）

---

# 2. 第二部分：接口与运维文档（面向运维/技术对接）

## 2.1 部署架构建议

推荐两种典型部署方式：

### 方式 A：单机部署（最简）

- MySQL：同机部署
- 后端服务：`dormitory-server`（8080）
- 前端：Nginx 静态资源（80/443），并反向代理 `/api` 到后端

### 方式 B：分离部署（推荐生产）

- 数据库服务器：MySQL（3306）
- 应用服务器：后端服务（8080）
- Web 服务器：Nginx（80/443）


## 2.2 环境要求

### 后端

- JDK：**17**
- Maven：3.8+（或使用项目自带的 mvnw）
- MySQL：8.x（推荐）

### 前端

- Node.js：18+（推荐 18/20）
- npm：与 Node 版本配套


## 2.3 配置说明（后端 application.yml）

配置文件：`dormitory-server/src/main/resources/application.yml`

| 配置项 | 含义 | 默认值 | 说明 |
| --- | --- | --- | --- |
| `server.port` | 后端端口 | `8080` | |
| `spring.datasource.url` | MySQL 连接串 | `jdbc:mysql://127.0.0.1:3306/dormitory...` | 需要提前创建数据库 `dormitory` |
| `spring.datasource.username` | DB 用户 | `root` | 生产建议专用账号 |
| `spring.datasource.password` | DB 密码 | `123456` | 生产务必修改 |
| `spring.flyway.enabled` | Flyway 开关 | `true` | |
| `spring.flyway.locations` | 迁移脚本路径 | `classpath:db/migration` | |
| `app.jwt.secret` | JWT 密钥 | 见 yml | 支持环境变量覆盖 `APP_JWT_SECRET` |
| `app.jwt.expiration-seconds` | Token 过期秒数 | `7200` | 支持环境变量覆盖 `APP_JWT_EXP_SECONDS` |


## 2.4 数据库说明

### 2.4.1 数据库初始化与迁移

- 迁移工具：Flyway
- 迁移目录：`dormitory-server/src/main/resources/db/migration`
- 当前版本（示例）：
  - `V1__init.sql`：核心业务表初始化
  - `V2__rbac_seed.sql`：RBAC 基础数据与默认账号
  - `V3__rbac_password_fix.sql`：修正默认账号密码哈希
  - `V4__m2_permissions_and_seed.sql`：宿舍/学生权限点与少量种子数据（B1/305、床位 A-D、学生 S0001）
  - `V5__...`：报修约束与权限
  - `V6__...`：访客约束与权限

### 2.4.2 表结构概览（摘要）

| 表名 | 作用 |
| --- | --- |
| `sys_user` | 系统用户 |
| `sys_role` | 角色 |
| `sys_permission` | 权限点 |
| `sys_user_role` | 用户-角色 |
| `sys_role_permission` | 角色-权限 |
| `dorm_building` | 楼栋 |
| `dorm_room` | 房间 |
| `dorm_bed` | 床位 |
| `student` | 学生 |
| `dorm_assignment` | 入住记录 |
| `repair_order` / `repair_log` | 报修工单与日志 |
| `visitor_record` | 访客登记 |
| `notice` | 公告（未实现接口） |
| `audit_log` | 审计日志（未实现接口） |


## 2.5 启动/停止/日志/健康检查

### 2.5.1 后端启动

项目：`dormitory-server`

常用方式（任选其一）：

- `mvn spring-boot:run`
- 或打包后运行：`java -jar target/dormitory-server-0.0.1-SNAPSHOT.jar`

启动前必须保证：

- MySQL 已启动
- 数据库 `dormitory` 已创建

### 2.5.2 健康检查

- `GET /actuator/health`
  - `management.endpoints.web.exposure.include=health,info`

- `GET /api/v1/ping`
  - 返回：`{"code":0,"message":"ok","data":"pong"}`（示例）

### 2.5.3 日志查看

- 默认输出到控制台（建议生产环境将 stdout 重定向到文件或接入日志系统）


## 2.6 前端构建与部署（Nginx 示例）

项目：`dormitory-admin-web`

### 2.6.1 开发启动

- 安装依赖：`npm install`
- 启动：`npm run dev`

> 开发模式依赖 Vite 代理 `/api` 到 `http://localhost:8080`。

### 2.6.2 生产构建

- 构建：`npm run build`
- 产物目录：`dormitory-admin-web/dist/`

### 2.6.3 Nginx 部署示例

将 `dist/` 上传到服务器，例如 `/var/www/dormitory-admin/`，Nginx 配置示例：

```nginx
server {
  listen 80;
  server_name your.domain.com;

  root /var/www/dormitory-admin;
  index index.html;

  location / {
    try_files $uri $uri/ /index.html;
  }

  location /api/ {
    proxy_pass http://127.0.0.1:8080;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }
}
```


## 2.7 API 统一约定（返回结构/认证/错误码）

### 2.7.1 返回结构

后端统一返回：`ApiResponse<T>`

```json
{
  "code": 0,
  "message": "ok",
  "data": {},
  "traceId": null
}
```

- `code = 0`：成功
- `code != 0`：失败，`message` 给出原因

### 2.7.2 认证方式

- 登录接口：`POST /api/v1/auth/login` 不需要 Token
- 其余 `/api/v1/**` 默认需要认证（JWT）
- 请求头：

```
Authorization: Bearer <token>
```

### 2.7.3 常见错误码与含义

| code | HTTP | 含义 | 典型场景 |
| --- | --- | --- | --- |
| 0 | 200 | 成功 | |
| 40001 | 400 | 参数校验失败/非法参数 | DTO 校验失败、非法枚举 |
| 40004 | 400 | 资源不存在 | building/room/bed/student 等不存在 |
| 40101 | 401 | 未认证 | Token 缺失/失效 |
| 40301 | 403 | 无权限 | 权限点不满足 |
| 40400 | 404 | 路径不存在 | URL 错误 |
| 40900 | 409 | 数据完整性冲突 | 外键/唯一键冲突等 |
| 40901~ | 409 | 业务冲突 | 入住冲突、访客重复离开、报修终态修改等 |
| 50000 | （实现中返回 400） | 系统错误 | 未捕获异常 |

> 提示：`50000` 在当前实现中由全局异常处理返回，但 HTTP 状态码标注为 400（以 `code` 为准）。


## 2.8 接口文档（按模块）

> Base URL：`http://<host>:8080/api/v1`

### 2.8.1 Ping

- `GET /api/v1/ping`
  - 认证：否
  - 权限：无


### 2.8.2 Auth（登录/当前用户）

#### 登录

- `POST /api/v1/auth/login`
  - 认证：否
  - 权限：无

请求体（`LoginRequest`）：

```json
{ "username": "admin", "password": "123456" }
```

返回（`LoginResponse`）：

```json
{ "code": 0, "message": "ok", "data": { "token": "..." } }
```

失败：
- `40101 unauthorized`

#### 当前用户信息

- `GET /api/v1/auth/me`
  - 认证：是

返回（`MeResponse`）：

```json
{
  "code": 0,
  "message": "ok",
  "data": {
    "id": 1,
    "username": "admin",
    "realName": "系统管理员",
    "roles": ["SUPER_ADMIN"],
    "permissions": ["dorm:building:read", "dorm:building:write", "..."]
  }
}
```


### 2.8.3 系统用户（Sys Users）

- `GET /api/v1/sys/users`
  - 认证：是
  - 权限：`sys:user:read`

返回：`ApiResponse<List<SysUserVo>>`

`SysUserVo` 字段：

- `id`
- `username`
- `realName`
- `status`


### 2.8.4 宿舍楼栋（Dorm Buildings）

#### 列表

- `GET /api/v1/dorm/buildings`
  - 权限：`dorm:building:read`

Query：
- `keyword`（可选）
- `genderLimit`（可选）
- `page`（可选，默认 1）
- `pageSize`（可选，默认 20，最大 200）
- `sortBy`（可选：`id/code/name/genderLimit/status`）
- `sortOrder`（可选：`asc/desc`，默认 `desc`）

返回：`ApiResponse<PageResult<DormBuildingVo>>`

#### 详情

- `GET /api/v1/dorm/buildings/{id}`
  - 权限：`dorm:building:read`

#### 创建

- `POST /api/v1/dorm/buildings`
  - 权限：`dorm:building:write`

请求体（`CreateDormBuildingRequest`）：
- `code`（必填）
- `name`（必填）
- `genderLimit`（必填）
- `address`（可选）
- `status`（可选，默认 `ACTIVE`）

#### 更新

- `PUT /api/v1/dorm/buildings/{id}`
  - 权限：`dorm:building:write`

请求体（`UpdateDormBuildingRequest`）：同创建

#### 删除

- `DELETE /api/v1/dorm/buildings/{id}`
  - 权限：`dorm:building:write`


### 2.8.5 宿舍房间（Dorm Rooms）

- `GET /api/v1/dorm/rooms`（权限：`dorm:room:read`）
  - Query：`buildingId/floorNo/roomNo/status/keyword/page/pageSize/sortBy/sortOrder`

- `GET /api/v1/dorm/rooms/{id}`（权限：`dorm:room:read`）

- `POST /api/v1/dorm/rooms`（权限：`dorm:room:write`）
  - Body（`CreateDormRoomRequest`）：
    - `buildingId`（必填）
    - `floorNo`（必填）
    - `roomNo`（必填）
    - `roomType`（可选）
    - `genderLimit`（可选，默认 `UNLIMITED`）
    - `status`（可选，默认 `ACTIVE`）

- `PUT /api/v1/dorm/rooms/{id}`（权限：`dorm:room:write`）
  - Body（`UpdateDormRoomRequest`）：同创建

- `DELETE /api/v1/dorm/rooms/{id}`（权限：`dorm:room:write`）


### 2.8.6 宿舍床位（Dorm Beds）

- `GET /api/v1/dorm/beds`（权限：`dorm:bed:read`）
  - Query：`buildingId/roomId/status/keyword/page/pageSize/sortBy/sortOrder`

- `GET /api/v1/dorm/beds/{id}`（权限：`dorm:bed:read`）

- `POST /api/v1/dorm/beds`（权限：`dorm:bed:write`）
  - Body（`CreateDormBedRequest`）：
    - `roomId`（必填）
    - `bedNo`（必填）
    - `status`（可选，默认 `AVAILABLE`）

- `PUT /api/v1/dorm/beds/{id}`（权限：`dorm:bed:write`）
  - Body（`UpdateDormBedRequest`）：同创建

- `DELETE /api/v1/dorm/beds/{id}`（权限：`dorm:bed:write`）


### 2.8.7 学生（Students）

- `GET /api/v1/students`（权限：`student:read`）
  - Query：`gender/status/keyword/page/pageSize/sortBy/sortOrder`

- `GET /api/v1/students/{id}`（权限：`student:read`）

- `POST /api/v1/students`（权限：`student:write`）
  - Body（`CreateStudentRequest`）：
    - `studentNo/name/gender`（必填）
    - `college/major/className/phone/status`（可选，`status` 默认 `IN_SCHOOL`）

- `PUT /api/v1/students/{id}`（权限：`student:write`）
  - Body（`UpdateStudentRequest`）：同创建

- `DELETE /api/v1/students/{id}`（权限：`student:write`）


### 2.8.8 入住记录（Dorm Assignments）

- `GET /api/v1/dorm/assignments`（权限：`dorm:assignment:read`）
  - Query：`studentId/buildingId/roomId/bedId/status/page/pageSize/sortBy/sortOrder`

- `GET /api/v1/dorm/assignments/{id}`（权限：`dorm:assignment:read`）

- `POST /api/v1/dorm/assignments`（权限：`dorm:assignment:write`）
  - Body（`CreateDormAssignmentRequest`）：
    - `studentId`（必填）
    - `bedId`（必填）
    - `reason`（可选）
  - 典型冲突错误：`40901`、`40902`

- `POST /api/v1/dorm/assignments/{id}/end`（权限：`dorm:assignment:write`）
  - Body（可选，`EndDormAssignmentRequest`）：`reason`（可选）


### 2.8.9 报修工单（Repairs）

- `GET /api/v1/repairs`（权限：`repair:order:read`）
  - Query：`status/priority/assigneeUserId/keyword/page/pageSize/sortBy/sortOrder`

- `GET /api/v1/repairs/{id}`（权限：`repair:order:read`）

- `POST /api/v1/repairs`（权限：`repair:order:write`）
  - Body（`CreateRepairRequest`）：
    - `title`（必填）
    - `description/priority/studentId/buildingId/roomId`（可选）

- `POST /api/v1/repairs/{id}/assign`（权限：`repair:order:assign`）
  - Body（`AssignRepairRequest`）：
    - `assigneeUserId`（必填）
    - `content`（可选）

- `POST /api/v1/repairs/{id}/transition`（权限：`repair:order:write`）
  - Body（`TransitionRepairRequest`）：
    - `status`（必填）
    - `content`（可选）

- `GET /api/v1/repairs/{id}/logs`（权限：`repair:log:read`）


### 2.8.10 访客登记（Visitors）

- `GET /api/v1/visitors`（权限：`visitor:record:read`）
  - Query：`status/keyword/fromAt/toAt/studentId/page/pageSize/sortBy/sortOrder`
  - 时间格式：`LocalDateTime.parse` 支持的格式（示例：`2025-12-23T10:30:00`）

- `GET /api/v1/visitors/{id}`（权限：`visitor:record:read`）

- `POST /api/v1/visitors`（权限：`visitor:record:write`）
  - Body（`CreateVisitorRecordRequest`）：
    - `visitorName`（必填）
    - `studentId/idNo/phone/visitReason/visitAt`（可选）

- `POST /api/v1/visitors/{id}/leave`（权限：`visitor:record:write`）
  - 访客重复离开：`40901 visitor already left`


## 2.9 权限点（Permission Codes）清单

系统已使用/预置的权限点（从代码与迁移脚本提取）：

- 系统：
  - `sys:user:read`

- 宿舍：
  - `dorm:building:read` / `dorm:building:write`
  - `dorm:room:read` / `dorm:room:write`
  - `dorm:bed:read` / `dorm:bed:write`
  - `dorm:assignment:read` / `dorm:assignment:write`

- 学生：
  - `student:read` / `student:write`

- 报修：
  - `repair:order:read`
  - `repair:order:write`
  - `repair:order:assign`
  - `repair:log:read`

- 访客：
  - `visitor:record:read`
  - `visitor:record:write`


## 2.10 故障排查（FAQ）

### 2.10.1 前端登录时报 500 / 接口不可用

- 检查后端是否启动（`/api/v1/ping` 是否返回 pong）
- 检查 Nginx/前端代理是否正确把 `/api` 转发到后端

### 2.10.2 登录成功后进入页面提示 401

- Token 过期（默认 7200 秒）
- JWT secret 变更导致旧 token 失效

处理：重新登录。

### 2.10.3 访问页面提示 403（无权限）

- 当前账号没有对应权限点
- 需要用 `admin`（SUPER_ADMIN）验证

### 2.10.4 Flyway 启动失败

- 可能原因：数据库不是空库、脚本执行过但内容被修改
- 处理思路：
  - 保持迁移脚本不可随意改动
  - 生产环境严禁删除 `flyway_schema_history`

### 2.10.5 数据库连接失败

- 检查 MySQL 是否启动
- 检查 `application.yml` 中 `spring.datasource.url/username/password`
- 确认数据库 `dormitory` 已创建


## 2.11 安全建议（强烈建议上线前完成）

- 立即修改默认账号密码（`admin/user`）
- 修改 JWT secret（通过环境变量 `APP_JWT_SECRET` 注入，避免写死在配置文件）
- 数据库账号最小权限化（不要长期使用 root）
- Nginx/网关层开启 HTTPS
- 限制 CORS 来源（当前后端允许 `*`，生产建议收敛到实际域名）

---

> 文档生成依据：本文件内容根据仓库 `/root/arrebol` 当前代码实际 Controller/DTO/VO/Flyway/application.yml 提取整理。
